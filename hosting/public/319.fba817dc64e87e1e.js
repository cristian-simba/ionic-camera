"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[319],{1889:(R,P,c)=>{c.d(P,{Wi:()=>b,__:()=>h});var h=function(p){return p.Documents="DOCUMENTS",p.Data="DATA",p.Library="LIBRARY",p.Cache="CACHE",p.External="EXTERNAL",p.ExternalStorage="EXTERNAL_STORAGE",p}(h||{}),b=function(p){return p.UTF8="utf8",p.ASCII="ascii",p.UTF16="utf16",p}(b||{})},319:(R,P,c)=>{c.r(P),c.d(P,{Tab2PageModule:()=>I});var h=c(1075),b=c(177),A=c(4341),E=c(1307),p=c(70),u=c(467),s=c(4438),f=c(5083),v=function(r){return r.Prompt="PROMPT",r.Camera="CAMERA",r.Photos="PHOTOS",r}(v||{}),g=function(r){return r.Rear="REAR",r.Front="FRONT",r}(g||{}),S=function(r){return r.Uri="uri",r.Base64="base64",r.DataUrl="dataUrl",r}(S||{});class F extends f.E_{getPhoto(n){var i=this;return(0,u.A)(function*(){return new Promise(function(){var e=(0,u.A)(function*(t,a){if(n.webUseInput||n.source===v.Photos)i.fileInputExperience(n,t,a);else if(n.source===v.Prompt){let o=document.querySelector("pwa-action-sheet");o||(o=document.createElement("pwa-action-sheet"),document.body.appendChild(o)),o.header=n.promptLabelHeader||"Photo",o.cancelable=!1,o.options=[{title:n.promptLabelPhoto||"From Photos"},{title:n.promptLabelPicture||"Take Picture"}],o.addEventListener("onSelection",function(){var l=(0,u.A)(function*(d){0===d.detail?i.fileInputExperience(n,t,a):i.cameraExperience(n,t,a)});return function(d){return l.apply(this,arguments)}}())}else i.cameraExperience(n,t,a)});return function(t,a){return e.apply(this,arguments)}}())})()}pickImages(n){var i=this;return(0,u.A)(function*(){return new Promise(function(){var e=(0,u.A)(function*(t,a){i.multipleFileInputExperience(t,a)});return function(t,a){return e.apply(this,arguments)}}())})()}cameraExperience(n,i,e){var t=this;return(0,u.A)(function*(){if(customElements.get("pwa-camera-modal")){const a=document.createElement("pwa-camera-modal");a.facingMode=n.direction===g.Front?"user":"environment",document.body.appendChild(a);try{yield a.componentOnReady(),a.addEventListener("onPhoto",function(){var o=(0,u.A)(function*(l){const d=l.detail;null===d?e(new f.I9("User cancelled photos app")):d instanceof Error?e(d):i(yield t._getCameraPhoto(d,n)),a.dismiss(),document.body.removeChild(a)});return function(l){return o.apply(this,arguments)}}()),a.present()}catch{t.fileInputExperience(n,i,e)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),t.fileInputExperience(n,i,e)})()}fileInputExperience(n,i,e){let t=document.querySelector("#_capacitor-camera-input");const a=()=>{var o;null===(o=t.parentNode)||void 0===o||o.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input",t.type="file",t.hidden=!0,document.body.appendChild(t),t.addEventListener("change",o=>{const l=t.files[0];let d="jpeg";if("image/png"===l.type?d="png":"image/gif"===l.type&&(d="gif"),"dataUrl"===n.resultType||"base64"===n.resultType){const m=new FileReader;m.addEventListener("load",()=>{if("dataUrl"===n.resultType)i({dataUrl:m.result,format:d});else if("base64"===n.resultType){const G=m.result.split(",")[1];i({base64String:G,format:d})}a()}),m.readAsDataURL(l)}else i({webPath:URL.createObjectURL(l),format:d}),a()}),t.addEventListener("cancel",o=>{e(new f.I9("User cancelled photos app")),a()})),t.accept="image/*",t.capture=!0,n.source===v.Photos||n.source===v.Prompt?t.removeAttribute("capture"):n.direction===g.Front?t.capture="user":n.direction===g.Rear&&(t.capture="environment"),t.click()}multipleFileInputExperience(n,i){let e=document.querySelector("#_capacitor-camera-input-multiple");const t=()=>{var a;null===(a=e.parentNode)||void 0===a||a.removeChild(e)};e||(e=document.createElement("input"),e.id="_capacitor-camera-input-multiple",e.type="file",e.hidden=!0,e.multiple=!0,document.body.appendChild(e),e.addEventListener("change",a=>{const o=[];for(let l=0;l<e.files.length;l++){const d=e.files[l];let m="jpeg";"image/png"===d.type?m="png":"image/gif"===d.type&&(m="gif"),o.push({webPath:URL.createObjectURL(d),format:m})}n({photos:o}),t()}),e.addEventListener("cancel",a=>{i(new f.I9("User cancelled photos app")),t()})),e.accept="image/*",e.click()}_getCameraPhoto(n,i){return new Promise((e,t)=>{const a=new FileReader,o=n.type.split("/")[1];"uri"===i.resultType?e({webPath:URL.createObjectURL(n),format:o,saved:!1}):(a.readAsDataURL(n),a.onloadend=()=>{const l=a.result;e("dataUrl"===i.resultType?{dataUrl:l,format:o,saved:!1}:{base64String:l.split(",")[1],format:o,saved:!1})},a.onerror=l=>{t(l)})})}checkPermissions(){var n=this;return(0,u.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw n.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw n.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var n=this;return(0,u.A)(function*(){throw n.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var n=this;return(0,u.A)(function*(){throw n.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var n=this;return(0,u.A)(function*(){throw n.unavailable("Not implemented on web.")})()}}new F;const U=(0,f.F3)("Camera",{web:()=>new F});var y=c(1889);const T=(0,f.F3)("Filesystem",{web:()=>c.e(2937).then(c.bind(c,2937)).then(r=>new r.FilesystemWeb)}),w=(0,f.F3)("Preferences",{web:()=>c.e(2924).then(c.bind(c,2924)).then(r=>new r.PreferencesWeb)});let O=(()=>{var r;class n{constructor(){this.photos=[],this.PHOTO_STORAGE="photos",this.convertBlobToBase64=e=>new Promise((t,a)=>{const o=new FileReader;o.onerror=a,o.onload=()=>{t(o.result)},o.readAsDataURL(e)})}addNewToGallery(){var e=this;return(0,u.A)(function*(){const t=yield U.getPhoto({resultType:S.Uri,source:v.Camera,quality:100}),a=yield e.savePicture(t);e.photos.unshift(a),yield w.set({key:e.PHOTO_STORAGE,value:JSON.stringify(e.photos)})})()}savePicture(e){var t=this;return(0,u.A)(function*(){const a=yield t.readAsBase64(e),o=Date.now()+".jpeg";return yield T.writeFile({path:o,data:a,directory:y.__.Data}),{filepath:o,webviewPath:e.webPath}})()}readAsBase64(e){var t=this;return(0,u.A)(function*(){const o=yield(yield fetch(e.webPath)).blob();return yield t.convertBlobToBase64(o)})()}loadSaved(){var e=this;return(0,u.A)(function*(){const{value:t}=yield w.get({key:e.PHOTO_STORAGE});e.photos=t?JSON.parse(t):[];for(let a of e.photos){const o=yield T.readFile({path:a.filepath,directory:y.__.Data});a.webviewPath=`data:image/jpeg;base64,${o.data}`}})()}deletePicture(e,t){var a=this;return(0,u.A)(function*(){a.photos.splice(t,1),w.set({key:a.PHOTO_STORAGE,value:JSON.stringify(a.photos)});const o=e.filepath.substr(e.filepath.lastIndexOf("/")+1);yield T.deleteFile({path:o,directory:y.__.Data})})()}}return(r=n).\u0275fac=function(e){return new(e||r)},r.\u0275prov=s.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}),n})();function L(r,n){if(1&r){const i=s.RV6();s.j41(0,"ion-col",5)(1,"ion-img",6),s.bIt("click",function(){const t=s.eBV(i),a=t.$implicit,o=t.index,l=s.XpG();return s.Njj(l.showActionSheet(a,o))}),s.k0s()()}if(2&r){const i=n.$implicit;s.R7$(),s.Y8G("src",i.webviewPath)}}const C=[{path:"",component:(()=>{var r;class n{constructor(e,t){this.photoService=e,this.actionSheetController=t}addPhotoToGallery(){this.photoService.addNewToGallery()}showActionSheet(e,t){var a=this;return(0,u.A)(function*(){yield(yield a.actionSheetController.create({header:"Photos",buttons:[{text:"Delete",role:"destructive",icon:"trash",handler:()=>{a.photoService.deletePicture(e,t)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{}}]})).present()})()}ngOnInit(){var e=this;return(0,u.A)(function*(){yield e.photoService.loadSaved()})()}}return(r=n).\u0275fac=function(e){return new(e||r)(s.rXU(O),s.rXU(h.GD))},r.\u0275cmp=s.VBU({type:r,selectors:[["app-tab2"]],decls:12,vars:2,consts:[[3,"translucent"],["size","6",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","center","slot","fixed"],[3,"click"],["name","camera"],["size","6"],[3,"click","src"]],template:function(e,t){1&e&&(s.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),s.EFF(3," Photo Gallery "),s.k0s()()(),s.j41(4,"ion-content")(5,"ion-grid")(6,"ion-row"),s.DNE(7,L,2,1,"ion-col",1),s.k0s()()(),s.j41(8,"ion-content")(9,"ion-fab",2)(10,"ion-fab-button",3),s.bIt("click",function(){return t.addPhotoToGallery()}),s.nrm(11,"ion-icon",4),s.k0s()()()),2&e&&(s.Y8G("translucent",!0),s.R7$(7),s.Y8G("ngForOf",t.photoService.photos))},dependencies:[h.hU,h.W9,h.Q8,h.YW,h.lO,h.eU,h.iq,h.KW,h.ln,h.BC,h.ai,b.Sq]}),n})()}];let x=(()=>{var r;class n{}return(r=n).\u0275fac=function(e){return new(e||r)},r.\u0275mod=s.$C({type:r}),r.\u0275inj=s.G2t({imports:[p.iI.forChild(C),p.iI]}),n})(),I=(()=>{var r;class n{}return(r=n).\u0275fac=function(e){return new(e||r)},r.\u0275mod=s.$C({type:r}),r.\u0275inj=s.G2t({imports:[h.bv,b.MD,A.YN,E.S,x]}),n})()}}]);